        try {
$bleh = @()
$strFilter = "(&(objectCategory=Person)(objectCategory=User)(sAMAccountName=HELLOUSER))"
$objDomain = New-Object System.DirectoryServices.DirectoryEntry
$objSearcher = New-Object System.DirectoryServices.DirectorySearcher
$objSearcher.SearchRoot = $objDomain
$objSearcher.PageSize = 1000
$objSearcher.Filter = $strFilter
$objSearcher.SearchScope = "Subtree"

$objSearcher.PropertiesToLoad.AddRange(@("name"))
$objSearcher.PropertiesToLoad.AddRange(@("samaccountname"))
$objSearcher.PropertiesToLoad.AddRange(@("distinguishedName"))
$objSearcher.PropertiesToLoad.AddRange(@("memberOf"))
$objSearcher.PropertiesToLoad.AddRange(@("lastLogon"))
$objSearcher.PropertiesToLoad.AddRange(@("givenName"))
$objSearcher.PropertiesToLoad.AddRange(@("SN"))
$objSearcher.PropertiesToLoad.AddRange(@("DisplayName"))
$objSearcher.PropertiesToLoad.AddRange(@("extensionAttribute1"))
$objSearcher.PropertiesToLoad.AddRange(@("extensionAttribute2"))
$objSearcher.PropertiesToLoad.AddRange(@("comment"))
$objSearcher.PropertiesToLoad.AddRange(@("title"))
$objSearcher.PropertiesToLoad.AddRange(@("mail"))
$objSearcher.PropertiesToLoad.AddRange(@("userAccountControl"))
$colResults = $objSearcher.FindAll() 

foreach ($objResult in $colResults){
    $objItem = $objResult.Properties
    
    $userGroup = @()
    $ADdistinguishename = 'LDAP://' + [string]($objResult.Properties.distinguishedname)
    $ADObject = [ADSI]($ADdistinguishename)
    $ADObject.psbase.RefreshCache("tokenGroups")
    $SIDs = $ADObject.psbase.Properties.Item("tokenGroups")
    ForEach ($Value In $SIDs) {
        $SID = New-Object System.Security.Principal.SecurityIdentifier $Value, 0
        $Group = $SID.Translate([System.Security.Principal.NTAccount])
        $usergroup += [string]$Group + ','
        }
    $bleh +=  ("name: {0} title: {1} mail: {2} displayname: {3} extension: {4} member of: {5} GivenName {6}  sn {7} UserAccountControl {8} comment {9}***" -f $($objitem.name), $($objitem.title), $($objitem.mail), $( $objitem.displayname), $($objitem.ExtensionAttribute1), $([string]($userGroup)), $( $objitem.givenname) , $($objitem.sn), $($objitem.useraccountcontrol) , $($objitem.comment) )
    
    }    
[String]::Join("***", $bleh) | Out-String
     }
catch {
    "***" | Out-String
    }
